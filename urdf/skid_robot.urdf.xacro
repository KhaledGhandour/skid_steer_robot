<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro" name="essam_robot">
    
    
    <xacro:include filename="$(find skid_steer_robot)/urdf/robot_pluging.gazebo.xacro"/>
    <xacro:include filename="$(find skid_steer_robot)/urdf/2d_lidar.urdf.xacro"/>
    <xacro:include filename="$(find skid_steer_robot)/urdf/_d435.urdf.xacro"/>
    <!-- <xacro:include filename="$(find skid_steer_robot)/urdf/mono_camera.xacro"/> -->
    <xacro:include filename="$(find skid_steer_robot)/urdf/imu.xacro"/>
    <xacro:include filename="$(find skid_steer_robot)/urdf/ultrasonic.xacro"/>
    <!-- <xacro:include filename="$(find skid_steer_robot)/urdf/3d_lidar.urdf.xacro"/> -->

    <xacro:sensor_d435 parent="base_link" use_nominal_extrinsics="true">
      <origin xyz="0.19 0 0.05" rpy="0 0 0"/>
    </xacro:sensor_d435>

    <link name="base_link">
        <inertial>
          <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
          <mass value="5.0"/>
          <inertia ixx="0.0" ixy="0.0" ixz="0.0" iyy="0.0" iyz="0.0" izz="0.0"/>
        </inertial>
        <visual name="">
          <origin xyz="0.0 0.0 0.05" rpy="0.0 0.0 0.0"/>
          <geometry>
            <box size="0.4 0.3 0.05"/>
          </geometry>
          <material name="base_link_material">
            <color rgba="0.0 0.0 1.0 1.0"/>
            <texture filename=""/>
          </material>
        </visual>
        <collision>
          <origin xyz="0.0 0.0 0.05" rpy="0.0 0.0 0.0"/>
          <geometry>
            <box size="0.4 0.3 0.05"/>
          </geometry>
        </collision>
    </link>

    <!-- macro wheel-->
    <xacro:macro name="leg" params="prefix">
        <link name="${prefix}_wheel">
            <inertial>
              <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
              <mass value="1.0"/>
              <inertia ixx="0.001" ixy="0.0" ixz="0.0" iyy="0.001" iyz="0.0" izz="0.001"/>
            </inertial>
            <visual name="">
              <origin xyz="0.0 0.0 0.0" rpy="1.5708 0.0 0.0"/>
              <geometry>
                <cylinder radius="0.06" length="0.02"/>
              </geometry>
              <material name="">
                <color rgba="0.0 0.0 0.0 1.0"/>
              </material>
            </visual>
            <collision>
              <geometry>
                <cylinder radius="0.06" length="0.02"/>
              </geometry>
            </collision>
        </link>
    </xacro:macro>
    <xacro:leg prefix="front_right" />
    <xacro:leg prefix="front_left" />
    <xacro:leg prefix="rear_right" />
    <xacro:leg prefix="rear_left" />


    <!-- jonts of wheel -->
    <joint name="front_right_wheel_joint" type="continuous">
      <origin xyz="0.16 -0.16 0.05" rpy="0.0 0.0 0.0"/>
      <parent link="base_link"/>
      <child link="front_right_wheel"/>
      <axis xyz="0.0 1.0 0.0"/>
      <limit lower="0.0" upper="0.0" effort="0.0" velocity="0.0"/>
    </joint> 


    <joint name="front_left_wheel_joint" type="continuous">
      <parent link="base_link"/>
      <child link="front_left_wheel"/>
      <origin xyz="0.16 0.16 0.05" rpy="0 0 0"/>
      <axis xyz="0 1 0"/>
    </joint>


    <joint name="rear_right_wheel_joint" type="continuous">
      <parent link="base_link"/>
      <child link="rear_right_wheel"/>
      <origin xyz="-0.16 -0.16 0.05" rpy="0 0 0"/>
      <axis xyz="0 1 0"/>
    </joint>

    <joint name="rear_left_wheel_joint" type="continuous">
      <parent link="base_link"/>
      <child link="rear_left_wheel"/>
      <origin xyz="-0.16 0.16 0.05" rpy="0 0 0"/>
      <axis xyz="0 1 0"/>
    </joint>




    <!-- A Dummy Link -->
    
    <link name="base_footprint">
    </link>

    <joint name="base_footprint_joint" type="fixed">
      <origin
        xyz="0.0 0.0 0.0"
        rpy="0 0 0" />
      <parent link ="base_footprint"/>
      <child link ="base_link"/>
    </joint>

    <!-- lidar_base_link -->


    <link name="lidar_base_link">
     <inertial>
        <origin xyz="0.0 0.0 0.0" rpy="0.0 0.0 0.0"/>
        <mass value="0.5"/> <!-- Adjust mass as needed -->
        <inertia ixx="0.0" ixy="0.0" ixz="0.0" iyy="0.0" iyz="0.0" izz="0.0"/>
     </inertial>
     <visual>
       <geometry>
          <box size="0.1 0.2 0.07"/>
       </geometry>
       <origin xyz="0 0 0.0"/>
       <material name="">
          <color rgba="0.0 0.0 1.0 1.0"/>
       </material>
     </visual>
     <collision>
       <geometry>
         <box size="0.2 0.2 0.07"/>
       </geometry>
       <origin xyz="0 0 0.3"/> <!-- Adjust position as needed -->
     </collision>
    </link>


    <joint name="lidar_base_joint" type="fixed">
      <parent link="base_link"/>
      <child link="lidar_base_link"/>
      <origin xyz="-0.1 0 0.1" rpy="0 0 0"/> <!-- Adjust height as needed -->
    </joint>









    

    



    <gazebo reference="front_left_wheel">
      <material>Gazebo/Black</material> 
    </gazebo>
    <gazebo reference="front_right_wheel">
      <material>Gazebo/Black</material>  
    </gazebo>
    <gazebo reference="rear_left_wheel">
      <material>Gazebo/Black</material>  
    </gazebo>
    <gazebo reference="rear_right_wheel">
      <material>Gazebo/Black</material>  
    </gazebo>
    <gazebo reference="base_link">
      <material>Gazebo/Blue</material>  
    </gazebo>
    <gazebo reference="lidar_base_link">
      <material>Gazebo/Blue</material>  
    </gazebo>







    
</robot>